{"paragraphs":[{"text":"%md\n# About\n**Objective:** Become familiar using the SparkNLP library to perform relationship extraction\n**File locations:** 'spark-labs/rel_extract_big.txt'\n**Successful outcome:** Extracted a list of CEO’s and the organization they run using NLP.\n**Before you begin:**\n**Related lessons:** NLP, NLP Libraries\n\n---","user":"admin","dateUpdated":"2019-04-10T09:48:50+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574613_1620257109","id":"20181210-150836_404677233","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:48:50+0000","dateFinished":"2019-04-10T09:48:50+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:174001"},{"text":"%md\n# Setup\n---","user":"admin","dateUpdated":"2019-04-10T09:48:50+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574614_1373063995","id":"20181210-151834_1331715166","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:48:50+0000","dateFinished":"2019-04-10T09:48:50+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174002"},{"title":"Retrieve the dataset and store it in HDFS","text":"%sh\n\nrm -f rel_extract_big.txt\nwget https://s3-us-west-1.amazonaws.com/sci-241/rel_extract/rel_extract_big.txt\nhdfs dfs -rm spark-labs/rel_extract_big.txt\nhdfs dfs -put rel_extract_big.txt spark-labs/","user":"admin","dateUpdated":"2019-04-10T09:48:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554889501338_2016378467","id":"20190410-094501_2076474379","dateCreated":"2019-04-10T09:45:01+0000","dateStarted":"2019-04-10T09:48:50+0000","dateFinished":"2019-04-10T09:48:58+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174003"},{"title":"Import libraries","text":"%pyspark\n\nfrom pyspark.sql.functions import trim\nfrom pyspark.ml import Pipeline\nfrom sparknlp.annotator import *\nfrom sparknlp.common import *\nfrom sparknlp.base import *\nfrom pyspark.sql.functions import explode, monotonically_increasing_id\nfrom pyspark.sql.functions import posexplode, array_contains, concat_ws\nfrom pyspark.sql.functions import regexp_extract","user":"admin","dateUpdated":"2019-04-10T09:48:58+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574614_-1417818998","id":"20181211-104110_721677353","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:48:58+0000","dateFinished":"2019-04-10T09:48:58+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174004"},{"text":"%md\n# Lab\n---","user":"admin","dateUpdated":"2019-04-10T09:48:58+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574614_-897872651","id":"20181210-151907_510933855","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:48:58+0000","dateFinished":"2019-04-10T09:48:58+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174005"},{"title":"1 - Load the data","text":"","user":"admin","dateUpdated":"2019-04-10T09:48:58+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574615_-2076259231","id":"20181210-152346_1912040133","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174006"},{"title":"2 - Inspect the data","text":"","user":"admin","dateUpdated":"2019-04-10T09:48:58+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574615_1914353178","id":"20181210-154204_1382498792","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174007"},{"text":"%md\nAs you can see from the above steps, several rows of our DataFrame don’t contain sentences:\n* Remove any lines that are empty or start with ‘=’\n* Rename the column of data from ‘value’ to ‘text’\n\nRun the code below to clean the data\n~~~\ncleaned = data.filter((trim(data.value) != \"\") & (trim(data.value).startswith(\"=\") == False) & (trim(data.value).startswith(\"--\") == False) )\ncleaned = cleaned.withColumnRenamed(\"value\", \"text\")\n~~~","user":"admin","dateUpdated":"2019-04-10T09:48:58+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574615_337207236","id":"20181217-083613_1236510294","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:48:58+0000","dateFinished":"2019-04-10T09:48:58+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174008"},{"title":"3 - Clean the Data","text":"","user":"admin","dateUpdated":"2019-04-10T09:48:58+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574615_805555959","id":"20181019-194136_141936001","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174009"},{"text":"%md\nNext we are going to break the documents into sentences using a SparkNLP pipeline composed of \n* a documentAssembler, \n* a sentenceDetector and \n* a finisher.","user":"admin","dateUpdated":"2019-04-10T09:48:58+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574615_80147957","id":"20181217-084059_291614616","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:48:58+0000","dateFinished":"2019-04-10T09:48:58+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174010"},{"title":"4 - Create the document assembler to convert the text into a form ready to be used by SparkNLP","text":"","user":"admin","dateUpdated":"2019-04-10T09:48:59+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574615_2018252416","id":"20181031-190303_1592455612","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174011"},{"title":"5 - Create the sentenceDetector","text":"","user":"admin","dateUpdated":"2019-04-10T09:48:59+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574615_740322233","id":"20181217-084621_1066063796","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174012"},{"title":"6 - Create the finisher object that will output an array of strings","text":"","user":"admin","dateUpdated":"2019-04-10T09:48:59+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574616_1639363298","id":"20181217-084815_1224839911","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174013"},{"title":"7 - Create the sentence detector pipeline","user":"admin","dateUpdated":"2019-04-10T09:48:59+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574616_1932482426","id":"20181217-085057_882686967","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174014"},{"title":"8 - Train and run the model to split the documents","user":"admin","dateUpdated":"2019-04-10T09:48:59+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574616_-1801944611","id":"20181217-085349_2044057583","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174015"},{"title":"9 - Inspect the sentences","user":"admin","dateUpdated":"2019-04-10T09:48:59+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574616_-1139049193","id":"20181217-085849_1798278836","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174016"},{"text":"%md\nNext we are going to \n* get each sentence into its own row,\n* rename the 'col' column to 'text'\n* add a unique index and then \n* filter those that contain 'CEO' for further processing.\n\n~~~\nsents_df = sentences.select(explode('finished_sentence'))\nsents_df = sents_df.withColumnRenamed('col','text')\n\nsents_df = sents_df.withColumn('id',monotonically_increasing_id())\nsents_to_process = sents_df.filter(sents_df.text.like(\"%CEO%\"))\n~~~","user":"admin","dateUpdated":"2019-04-10T09:48:59+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574616_1903539164","id":"20181217-090913_2000856435","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:48:59+0000","dateFinished":"2019-04-10T09:48:59+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174017"},{"title":"10 - Transform the Sentences into Their Own Rows and filter those that contain 'CEO'","text":"","user":"admin","dateUpdated":"2019-04-10T09:48:59+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574617_878940212","id":"20181217-091256_710972012","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174018"},{"text":"%md\nNext we are going to build a new SparkNLP pipeline to perform entity recognition.\nIt will build on the previous one and add the following stages:\n* a tokenizer,\n* a tagger,\n* a converter and\n* a ner finisher.\n\n~~~\ntokenizer = Tokenizer().setInputCols([\"document\"]).setOutputCol(\"token\")\nner_tagger = NerDLModel().pretrained().setInputCols([\"sentence\", \"token\"]).setOutputCol(\"ner\")\nconverter = NerConverter().setInputCols([\"document\", \"token\", \"ner\"]).setOutputCol(\"ner_span\")\nner_finisher = Finisher().setInputCols([\"ner_span\"]).setIncludeMetadata(True).setOutputAsArray(True)\n~~~","user":"admin","dateUpdated":"2019-04-10T09:48:59+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574617_703718793","id":"20181217-091835_1535968591","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:48:59+0000","dateFinished":"2019-04-10T09:48:59+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174019"},{"title":"11 - Create the tokenizer","text":"","user":"admin","dateUpdated":"2019-04-10T09:48:59+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574617_-219077452","id":"20181217-092819_1484632797","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174020"},{"title":"12 - Create the Named Entity Recognition object from a pretrained model","user":"admin","dateUpdated":"2019-04-10T09:48:59+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574617_-1714638721","id":"20181217-092944_702033111","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174021"},{"text":"%md\nThe format of the nerTagger is hard to use, so include another step in the pipeline to convert it to something more usable","user":"admin","dateUpdated":"2019-04-10T09:48:59+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574617_1196166900","id":"20181217-133533_956817659","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:49:00+0000","dateFinished":"2019-04-10T09:49:00+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174022"},{"title":"13 - Create the converter","user":"admin","dateUpdated":"2019-04-10T09:49:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574617_1264195013","id":"20181217-093256_1330557373","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174023"},{"title":"14 - Make a finisher object to get the entities in an array","user":"admin","dateUpdated":"2019-04-10T09:49:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574617_1559309816","id":"20181217-093457_1147402531","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174024"},{"title":"15 - Build the new pipeline","user":"admin","dateUpdated":"2019-04-10T09:49:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574618_-1912479243","id":"20181217-094022_1286745194","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174025"},{"title":"16 - Perform Entity Recognition","text":"","user":"admin","dateUpdated":"2019-04-10T09:49:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574618_-33234900","id":"20181018-142837_389338032","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174026"},{"title":"17 - Inspect results","user":"admin","dateUpdated":"2019-04-10T09:49:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574618_-1803103455","id":"20181217-094428_480387358","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174027"},{"text":"%md\nNext we are going to build pairs of persons and organizations.","user":"admin","dateUpdated":"2019-04-10T09:49:00+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574618_364236048","id":"20181217-100216_980770563","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:49:00+0000","dateFinished":"2019-04-10T09:49:00+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174028"},{"title":"18 - Create a dataframe containing the entities and their positions in the sentences","text":"","user":"admin","dateUpdated":"2019-04-10T09:49:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574618_-451143748","id":"20181217-100724_657947671","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174029"},{"title":"19 - Create a dataframe containing the type of entities and their positions in the sentences","user":"admin","dateUpdated":"2019-04-10T09:49:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574618_1548849484","id":"20181217-101445_1966254334","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174030"},{"title":"20 - Join the two previous dataframes on sentence id and position","user":"admin","dateUpdated":"2019-04-10T09:49:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574619_-1749120934","id":"20181217-101724_199347253","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174031"},{"title":"21 - Create a dataframe containing only the people from the previous one","user":"admin","dateUpdated":"2019-04-10T09:49:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574619_-1166100393","id":"20181217-102455_241598530","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174032"},{"title":"22 - Create a dataframe containing only the organizations from the previous one","user":"admin","dateUpdated":"2019-04-10T09:49:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574619_168041315","id":"20181217-102808_125602359","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174033"},{"title":"23 - Join the two previous dataframes and the result of the Entity Recognition on sentence id","user":"admin","dateUpdated":"2019-04-10T09:49:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574620_1806133983","id":"20181217-103253_1427766203","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174034"},{"text":"%md\nExtract the pairs of organizations and people that appear in the pattern\n“'ORGANIZATION' CEO 'PERSON'”","user":"admin","dateUpdated":"2019-04-10T09:49:01+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574620_-945776379","id":"20181217-133934_998769931","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:49:01+0000","dateFinished":"2019-04-10T09:49:01+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174035"},{"title":"24 - Extract the Pairs","user":"admin","dateUpdated":"2019-04-10T09:49:01+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574620_1996940334","id":"20181217-103810_1347864345","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174036"},{"title":"25 - Count the pairs of organizations and persons","user":"admin","dateUpdated":"2019-04-10T09:49:01+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574620_-2132191956","id":"20181217-104950_1169530360","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174037"},{"title":"26 - Filter out those for which count equals 1","text":"","user":"admin","dateUpdated":"2019-04-10T09:49:01+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574620_1470826014","id":"20181217-110047_42065475","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174038"},{"title":"Bonus","text":"%md\nIf time remains, use the pairs you found to look for new patterns.\n1. Build patterns out of each pair\n2. Get the patterns as Python list as PySpark doesn’t currently support using patterns from columns\n3. Find the text in the sentences that matches the two patterns\n4. Merge the patterns together\n5. Use the most common patterns","user":"admin","dateUpdated":"2019-04-10T09:49:01+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574621_1062982206","id":"20181217-110737_1190576128","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:49:01+0000","dateFinished":"2019-04-10T09:49:01+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174039"},{"text":"%md\n# Result\n**You have now:** You have now extracted a list of CEO’s and the corporations they are associated with using SparkNLP.\n\n---\n","user":"admin","dateUpdated":"2019-04-10T09:49:01+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574621_1176665050","id":"20181217-132324_184197001","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:49:01+0000","dateFinished":"2019-04-10T09:49:01+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174040"},{"text":"%md\n# Solution\n---","user":"admin","dateUpdated":"2019-04-10T09:49:01+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574621_-1015808061","id":"20181031-203101_1731924588","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:49:01+0000","dateFinished":"2019-04-10T09:49:01+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174041"},{"title":"1 - Load the data","text":"%pyspark\n\ndata = spark.read.text('spark-labs/rel_extract_big.txt')","user":"admin","dateUpdated":"2019-04-10T09:49:01+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574621_-2079212645","id":"20181018-143108_1211296637","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:49:01+0000","dateFinished":"2019-04-10T09:49:01+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174042"},{"title":"2 - Inspect the data","text":"%pyspark\n\nz.show(data)","user":"admin","dateUpdated":"2019-04-10T09:49:02+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"value":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8602"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408574621_534099191","id":"20181031-185338_830626804","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:49:02+0000","dateFinished":"2019-04-10T09:49:02+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174043"},{"title":"3. Clean the Data","text":"%pyspark\n\ncleaned = data.filter((trim(data.value) != \"\") & (trim(data.value).startswith(\"=\") == False) & (trim(data.value).startswith(\"--\") == False) )\ncleaned = cleaned.withColumnRenamed(\"value\", \"text\")","user":"admin","dateUpdated":"2019-04-10T09:49:02+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574622_2109741259","id":"20181211-104046_253985409","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:49:02+0000","dateFinished":"2019-04-10T09:49:02+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174044"},{"title":"4 - Create the document assembler to convert the text into a form ready to be used by SparkNLP","text":"%pyspark\ndocumentAssembler = DocumentAssembler().setInputCol(\"text\").setOutputCol(\"document\")","user":"admin","dateUpdated":"2019-04-10T09:49:02+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574622_-789114319","id":"20181031-190312_315753681","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:49:02+0000","dateFinished":"2019-04-10T09:49:02+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174045"},{"title":"5 - Create the sentenceDetector","text":"%pyspark\nsentenceDetector = SentenceDetector().setInputCols([\"document\"]).setOutputCol(\"sentence\")","user":"admin","dateUpdated":"2019-04-10T09:49:02+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574622_1617710782","id":"20181031-190608_1102650615","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:49:02+0000","dateFinished":"2019-04-10T09:49:02+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174046"},{"title":"6 - Create the finisher object that will output an array of strings","text":"%pyspark\nfinisher = Finisher().setInputCols([\"sentence\"]).setOutputAsArray(True) ","user":"admin","dateUpdated":"2019-04-10T09:49:02+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574622_-1036897960","id":"20181031-190622_1549955547","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:49:03+0000","dateFinished":"2019-04-10T09:49:03+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174047"},{"title":"7 - Create the sentence detector pipeline","text":"%pyspark\nsentence_pipe = Pipeline(\n    stages = [\n    documentAssembler,\n    sentenceDetector,\n    finisher\n  ])","user":"admin","dateUpdated":"2019-04-10T09:49:03+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574622_307497103","id":"20181031-190800_1633480487","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:49:03+0000","dateFinished":"2019-04-10T09:49:03+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174048"},{"title":"8 - Train and run the model to split the documents","text":"%pyspark\n\nmodel = sentence_pipe.fit(cleaned)\nsentences = model.transform(cleaned).cache()","user":"admin","dateUpdated":"2019-04-10T09:49:03+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574622_2053877308","id":"20181025-164135_1770697560","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:49:03+0000","dateFinished":"2019-04-10T09:49:03+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174049"},{"title":"9 - Inspect the sentences","text":"%pyspark\nz.show(sentences)","user":"admin","dateUpdated":"2019-04-10T09:49:03+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"text":"string","finished_sentence":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8603"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408574623_1501406281","id":"20181217-085702_2110857106","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:49:03+0000","dateFinished":"2019-04-10T09:49:32+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174050"},{"title":"10 - Transform the Sentences into Their Own Rows and filter those that contain 'CEO'","text":"%pyspark\nsents_df = sentences.select(explode('finished_sentence'))\nsents_df = sents_df.withColumnRenamed('col','text')\n\nsents_df = sents_df.withColumn('id',monotonically_increasing_id())\nsents_to_process = sents_df.filter(sents_df.text.like(\"%CEO%\"))","user":"admin","dateUpdated":"2019-04-10T09:49:33+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574623_917964326","id":"20181025-164313_1572443408","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:49:33+0000","dateFinished":"2019-04-10T09:49:33+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174051"},{"title":"11 - Create the tokenizer","text":"%pyspark\n\ntokenizer = Tokenizer().setInputCols([\"document\"]).setOutputCol(\"token\")","user":"admin","dateUpdated":"2019-04-10T09:49:33+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574623_-87620181","id":"20181031-192459_628606082","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:49:33+0000","dateFinished":"2019-04-10T09:49:33+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174052"},{"title":"12 - Create the Named Entity Recognition object from a pretrained model","text":"%pyspark\n\nner_tagger = NerDLModel().pretrained().setInputCols([\"sentence\", \"token\"]).setOutputCol(\"ner\")","user":"admin","dateUpdated":"2019-04-10T09:49:33+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8604","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8605","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8606","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8607"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408574623_607103984","id":"20181031-215513_206234763","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:49:33+0000","dateFinished":"2019-04-10T09:49:55+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174053"},{"title":"13 - Create the converter","text":"%pyspark\n\nconverter = NerConverter().setInputCols([\"document\", \"token\", \"ner\"]).setOutputCol(\"ner_span\")","user":"admin","dateUpdated":"2019-04-10T09:49:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574623_1103354314","id":"20181031-192721_276020891","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:49:55+0000","dateFinished":"2019-04-10T09:49:55+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174054"},{"title":"14 - Make a finisher object to get the entities in an array","text":"%pyspark\n\nner_finisher = Finisher().setInputCols([\"ner_span\"]).setIncludeMetadata(True).setOutputAsArray(True) ","user":"admin","dateUpdated":"2019-04-10T09:49:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574623_1894287965","id":"20181031-192924_1918998857","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:49:55+0000","dateFinished":"2019-04-10T09:49:55+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174055"},{"title":"15 - Build the new pipeline","text":"%pyspark\nner_pipeline = Pipeline(\n    stages = [\n    documentAssembler,\n    sentenceDetector,\n    tokenizer,\n    ner_tagger,\n    converter,\n    ner_finisher\n  ])","user":"admin","dateUpdated":"2019-04-10T09:49:56+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574624_-1192304425","id":"20181031-192937_1708038040","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:49:56+0000","dateFinished":"2019-04-10T09:49:56+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174056"},{"title":"16 - Perform Entity Recognition","text":"%pyspark\n\nner_model = ner_pipeline.fit(sents_to_process)\nprocessed = ner_model.transform(sents_to_process).cache()","user":"admin","dateUpdated":"2019-04-10T09:49:56+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574624_27375084","id":"20181217-094310_281994514","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:49:56+0000","dateFinished":"2019-04-10T09:50:05+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174057"},{"title":"17 - Inspect results","text":"%pyspark\n\nz.show(processed)","user":"admin","dateUpdated":"2019-04-10T09:50:05+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"text":"string","id":"string","finished_ner_span":"string","finished_ner_span_md":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8608","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8609"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408574624_1699734614","id":"20181031-193244_1973571970","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:50:05+0000","dateFinished":"2019-04-10T09:51:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174058"},{"title":"18 - Create a dataframe containing the entities and their positions in the sentences","text":"%pyspark\n\nner = processed.select('id',posexplode('finished_ner_span').alias('pos','entity'))","user":"admin","dateUpdated":"2019-04-10T09:51:07+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","pos":"string","entity":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574624_-2085552220","id":"20181031-194242_1142081581","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:51:07+0000","dateFinished":"2019-04-10T09:51:07+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174059"},{"title":"19 - Create a dataframe containing the type of entities and their positions in the sentences","text":"%pyspark\n\nner_md = processed.select('id',posexplode('finished_ner_span_md').alias('pos','ent_type'))","user":"admin","dateUpdated":"2019-04-10T09:51:07+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","pos":"string","ent_type":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574624_2143765363","id":"20181031-194425_771743571","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:51:07+0000","dateFinished":"2019-04-10T09:51:07+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174060"},{"title":"20 - Join the two previous dataframes on sentence id and position","text":"%pyspark\nents  = ner.join(ner_md,on=['id','pos']).cache()\nz.show(ents)","user":"admin","dateUpdated":"2019-04-10T09:51:07+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","pos":"string","entity":"string","ent_type":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8610","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8611"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408574625_-1737355514","id":"20181031-194431_1989658153","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:51:07+0000","dateFinished":"2019-04-10T09:51:21+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174061"},{"title":"21 - Create a dataframe containing only the people from the previous one","text":"%pyspark\n\npeople = ents.filter(ents.ent_type[\"_2\"] == \"PER\").withColumnRenamed(\"entity\", \"person\").drop('pos')\nz.show(people)","user":"admin","dateUpdated":"2019-04-10T09:51:21+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","person":"string","ent_type":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8612"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408574625_264291856","id":"20181031-194647_66319431","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:51:22+0000","dateFinished":"2019-04-10T09:51:25+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174062"},{"title":"22 - Create a dataframe containing only the organizations from the previous one","text":"%pyspark\n\norgs = ents.filter(ents.ent_type[\"_2\"] == \"ORG\").withColumnRenamed(\"entity\", \"organization\").drop('pos')\nz.show(orgs)","user":"admin","dateUpdated":"2019-04-10T09:51:25+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","organization":"string","ent_type":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8613"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408574625_1617157328","id":"20181031-194746_1805730840","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:51:25+0000","dateFinished":"2019-04-10T09:51:29+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174063"},{"title":"23 - Join the two previous dataframes and the result of the Entity Recognition on sentence id","text":"%pyspark\n\nto_find = orgs.join(people,on=['id']).join(processed,on=['id']).distinct()\nz.show(to_find)","user":"admin","dateUpdated":"2019-04-10T09:51:29+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","organization":"string","ent_type":"string","person":"string","text":"string","finished_ner_span":"string","finished_ner_span_md":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8614","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8615","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8616","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8617","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8618","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8619"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408574625_-1653978238","id":"20181031-194851_1389347926","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:51:29+0000","dateFinished":"2019-04-10T09:52:13+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174064"},{"title":"24 - Extract the Pairs","text":"%pyspark\n\npairs = to_find.filter(to_find.text.contains(concat_ws(\" CEO \",\"organization\",\"person\"))).cache()\nz.show(pairs)","user":"admin","dateUpdated":"2019-04-10T09:52:13+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","organization":"string","ent_type":"string","person":"string","text":"string","finished_ner_span":"string","finished_ner_span_md":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8620","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8621","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8622","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8623","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8624","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8625","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8626"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408574626_208613173","id":"20181019-195317_435086721","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:52:13+0000","dateFinished":"2019-04-10T09:54:26+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174065"},{"title":"25 - Count the pairs of organizations and persons","text":"%pyspark\n\nceo_counts = pairs.groupby(['organization','person']).count()\nz.show(ceo_counts)","user":"admin","dateUpdated":"2019-04-10T09:54:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"organization":"string","person":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8627","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8628","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8629","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8630","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8631"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408574626_-1447429672","id":"20181019-213935_211233859","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:54:27+0000","dateFinished":"2019-04-10T09:55:29+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174066"},{"text":"%pyspark\n","user":"admin","dateUpdated":"2019-04-10T09:55:29+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574626_-690093476","id":"20181217-135314_1633034128","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174067"},{"title":"26 - Filter out those for which count equals 1","text":"%pyspark\n\nextracted = ceo_counts.filter('count > 1').cache()\nz.show(extracted)","user":"admin","dateUpdated":"2019-04-10T09:55:29+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"organization":"string","person":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8632","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8633","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8634","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8635","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8636"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408574626_-1775897604","id":"20181026-160743_1171036707","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:55:29+0000","dateFinished":"2019-04-10T09:56:29+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174068"},{"title":"Bonus #1 - Build patterns out of each pair","text":"%pyspark\n\npatterns = extracted.withColumn('pattern1', concat_ws(\"(.*?)\",\"organization\",\"person\")).withColumn('pattern2', concat_ws(\"(.*?)\",\"person\",\"organization\"))\nz.show(patterns)\n","user":"admin","dateUpdated":"2019-04-10T09:56:29+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"organization":"string","person":"string","count":"string","pattern1":"string","pattern2":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8637","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8638","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8639","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8640","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8641"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408574627_-1378056858","id":"20181031-195508_1593900730","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:56:30+0000","dateFinished":"2019-04-10T09:58:41+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174069"},{"title":"Bonus #2 - Get the patterns as Python list","text":"%pyspark\n\npattern1_list = patterns.select('pattern1').rdd.map(lambda x: x['pattern1']).collect()\npattern2_list = patterns.select('pattern2').rdd.map(lambda x: x['pattern2']).collect()","user":"admin","dateUpdated":"2019-04-10T09:58:41+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8642","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8643"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408574627_1980592738","id":"20181031-202632_1100812084","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:58:42+0000","dateFinished":"2019-04-10T09:59:44+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174070"},{"title":"Bonus #3 - Find the text in the sentences that matches the two patterns","text":"%pyspark\n\npatterns_found = []\nfor pattern in pattern1_list:\n    temp_patterns = sents_df.withColumn(\"pattern\", regexp_extract(\"text\",pattern,1))\n    patterns_found.append(temp_patterns.filter(trim(temp_patterns.pattern) != \"\"))\n\nfor pattern in pattern2_list:\n    temp_patterns = sents_df.withColumn(\"pattern\", regexp_extract(\"text\",pattern,1))\n    patterns_found.append(temp_patterns.filter(trim(temp_patterns.pattern) != \"\"))\n\n","user":"admin","dateUpdated":"2019-04-10T09:59:45+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574627_-717207326","id":"20181031-224232_379243507","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:59:45+0000","dateFinished":"2019-04-10T09:59:47+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174071"},{"title":"Bonus #4 - Merge the patterns together","text":"%pyspark\n\npatterns = patterns_found[0]\nfor i in range(1,len(patterns_found)):\n    patterns = patterns.union(patterns_found[i])","user":"admin","dateUpdated":"2019-04-10T09:59:48+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574627_-1380248240","id":"20181031-225624_1661113650","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:59:48+0000","dateFinished":"2019-04-10T09:59:49+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174072"},{"title":"Bonus #5 - Use the most common patterns","text":"%pyspark\n\npat_counts = patterns.groupby('pattern').count().filter(\"count > 2\")\nz.show(pat_counts)","user":"admin","dateUpdated":"2019-04-10T09:59:49+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"pattern":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8644","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8645","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8646","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8647","http://ip-172-31-1-200.eu-central-1.compute.internal:4040/jobs/job?id=8648"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1548408574628_2018001697","id":"20181031-200455_97919720","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T09:59:49+0000","dateFinished":"2019-04-10T10:00:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174073"},{"title":"Additional resources","text":"%md\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Hortonworks Apache Spark Tutorials](http://hortonworks.com/tutorials/#tuts-developers) are your natural next step where you can explore Spark in more depth.\n2. [Hortonworks Community Connection (HCC)](https://community.hortonworks.com/spaces/85/data-science.html?type=question) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Hortonworks Apache Spark Docs](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/spark-overview/content/analyzing_data_with_apache_spark.html) - official Spark documentation.\n4. [Hortonworks Apache Zeppelin Docs](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/zeppelin-overview/content/overview.html) - official Zeppelin documentation.\n","user":"admin","dateUpdated":"2019-04-10T10:00:06+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":10,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574628_2064653666","id":"20181210-152008_1640061586","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T10:00:06+0000","dateFinished":"2019-04-10T10:00:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174074"},{"text":"%angular\n</br>\n<center>\n<a href=\"https://learn.hortonworks.com/\">\n  <img src=\"https://everpath-course-content.s3-accelerate.amazonaws.com/instructor%2Ftbroas_hortonworks_c_bsns5k%2Fpublic%2Flogo-training-1.1494860458677.png\" alt=\"Hortonworks University\" style=\"width:125px;height:125px;border:0;\" align=\"middle\">\n</a>\n</center>","user":"admin","dateUpdated":"2019-04-10T10:00:06+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":2,"editorMode":"ace/mode/undefined","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574628_1318994144","id":"20181210-152250_1113104174","dateCreated":"2019-01-25T10:29:34+0000","dateStarted":"2019-04-10T10:00:06+0000","dateFinished":"2019-04-10T10:00:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174075"},{"text":"%angular\n","user":"admin","dateUpdated":"2019-04-10T10:00:06+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/undefined","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548408574628_-1558242291","id":"20181210-152301_1895823478","dateCreated":"2019-01-25T10:29:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:174076"}],"name":"Labs/SparkNLP","id":"2E2JDSVAH","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"python:shared_process":[],"angular:shared_process":[],"sh:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}
